<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Week 8: Tidy Data</title>
    <meta charset="utf-8" />
    <meta name="author" content="Joe Nese University of Oregon Fall 2022" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/freezeframe/freezeframe.min.js"></script>
    <script src="libs/xaringanExtra-freezeframe/freezeframe-init.js"></script>
    <script id="xaringanExtra-freezeframe-options" type="application/json">{"selector":"img[src$=\"gif\"]","trigger":"click","overlay":false,"responsive":true,"warnings":true}</script>
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Week 8: Tidy Data
]
.subtitle[
## <code>{tidyr}</code>
]
.author[
### Joe Nese<br><span style="font-size: 50%;">University of Oregon<br>Fall 2022</span>
]

---








class: inverse, left, middle

## Share

### Tony

---
class: inverse, left, middle

# Tidy Data 
## Week 8


---
# Share

[`{tidylog}`](https://github.com/elbersb/tidylog)

* Provides feedback about `{dplyr}` and `{tidyr}` operations

.darkorange[[view link]]

---
## How I feel about my `R` code sometimes

&lt;img src="images/mr_rodgers.png" width="40%" height="40%" style="display: block; margin: auto;" /&gt;

---
# Agenda

* Introduce the concept of tidy data
* Tidy a simple dataset together with `{tidyr}`
* Summarize and transform tidy data with `{dplyr}`

**Learning Objectives**

* Understand that the concept of tidy data is useful
* Understand and be able to apply the `pivot_longer()` and `pivot_wider()` functions

---

background-size: contain

background-image: url("https://www.tidyverse.org/images/tidyverse-default.png")

---
# Providing grammar for:

* Graphics 
  + `{ggplot2}`
* Data manipulations 
  + `{dplyr}`
  + `{tidyr}`
* Expanding area of specialized topics
  + `{lubridate}`
  + `{glue}`
  + `{tidymodels}`
* Many more...

---

# Providing grammar for:

* Graphics 
  + `{ggplot2}`
* Data manipulations
  + `{dplyr}`
  + .bg-yellow[`{tidyr}`]
* Expanding area of specialized topics
  + `{lubridate}`
  + `{glue}`
  + `{tidymodels}`
* Many more...


---
class: inverse, left, middle

# {tidyr}

---
# `{dplyr}` vs `{tidyr}`

.pull-left[
**`{dplyr} `**

Helps you manipulate your data
* `select()`
* `filter()`
* `mutate()`
* `summarize()`
* more...
]

.pull-right[
**`{tidyr}`**

Helps you get your data into a tidy format
* `pivot_longer()`
* `pivot_wider()`
* `separate()` and `extract()`
* `unite()`
* `nest()`
]

--

Talk with a neighbor about what you think `pivot_longer()` and `pivot_wider()` do

<div class="countdown" id="timer_a180017b" data-warn-when="30" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">30</span></code>
</div>

---
# Data cleaning

&gt; “It is often said that 80% of data analysis is spent on the process of cleaning and preparing the data (Dasu &amp; Johnson, 2003).”
&gt; - Hadley Wickham (Tidy Data)

&lt;br&gt;
&lt;br&gt;
* Persistent and varied challenge

* Little research on how to do it well

---
# Tidy Data

* Each variable is a column
* Each observation is a row
* Each type of observational unit forms a table
  + We won’t talk much about this point
  
&lt;img src="https://d33wubrfki0l68.cloudfront.net/6f1ddb544fc5c69a2478e444ab8112fb0eea23f8/91adc/images/tidy-1.png" width="60%" style="display: block; margin: auto;" /&gt;

.footnote[
[R4DS](https://r4ds.had.co.nz/tidy-data.html)
]

---
background-image: url(https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidydata_1.jpg)
background-size: contain

.footnote[
[Allison Horst](https://github.com/allisonhorst/stats-illustrations)
]

---
# Common ways data are "messy"

* Column headers are values, not variable names

* Multiple variables stored in one column

* Variables are stored in both rows and columns
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
* See the pivoting [vignette](https://tidyr.tidyverse.org/articles/pivot.html) for examples and solutions

---
background-image: url(https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidydata_2.jpg)
background-size: contain

.footnote[
[Allison Horst](https://github.com/allisonhorst/stats-illustrations)
]

---
# Defining tidy data

**Essentially, two rules define tidy data**&lt;sup&gt;1&lt;/sup&gt; 

1. Each row is a case representing the same underlying attribute
2. Each column is a variable containing the same type of value for each case

The combination of rows and columns make each observational unit (row) unique, even though cells may be repeated many times (e.g., student identifier)

.footnote[
&lt;sup&gt;1&lt;/sup&gt; [Modern Data Science with R](https://mdsr-book.github.io/)
]

---
# Why tidy?

* There are many reasons why you might want to have "messy" data

  + e.g., for other software or specific modeling purposes

--

* However, tidy data is an extremely useful format generally, and particularly useful when applying tools within the `{tidyverse}`

--

* All packages within the `{tidyverse}` are designed to either help you get your data in a tidy format, or assume your data are already in a tidy format

--

* Assuming a common data format leads to large jumps in efficiency, as the output from certain functions can be directly input into others

---
background-image: url(https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidydata_3.jpg)
background-size: contain

.footnote[
[Allison Horst](https://github.com/allisonhorst/stats-illustrations)
]

---
background-image: url(https://d33wubrfki0l68.cloudfront.net/795c039ba2520455d833b4034befc8cf360a70ba/558a5/diagrams/data-science-explore.png)
background-size: contain

.footnote[
[R4DS](https://r4ds.had.co.nz/tidy-data.html)
]

---
# `{tidyr}` verbs

--

`pivot_longer()`
--
: "lengthens" data, increasing the number of rows and decreasing the number of columns

--

`pivot_wider()`
--
: "widens" data, increasing the number of columns and decreasing the number of rows

--

`separate()`
--
: turns a single character column into multiple columns

--

`extract()`
--
: given a [regular expression](https://r4ds.had.co.nz/strings.html#matching-patterns-with-regular-expressions) for capturing groups, turns each group into a new column

--

`unite()`
--
: paste together multiple columns into one

--

`nest()`
--
: creates a list-column of data frames; you get one row for each group defined by the non-nested columns. This is useful in conjunction with other summaries that work with whole datasets, like models

--
  + **so** powerful

---
class: inverse, left, middle

# pivot_longer()

---
# `pivot_longer()`

There are different ways to `pivot_longer()` that will depend on what your data look like 

.pull-left[

```r
pivot_longer(
  data,
  cols,
  names_to = "name",
  names_prefix = NULL,
  names_sep = NULL,
  names_pattern = NULL,
  names_ptypes = list(),
  names_transform = list(),
  names_repair = "check_unique",
  values_to = "value",
  values_drop_na = FALSE,
  values_ptypes = list(),
  values_transform = list(),
  ...
)
```
]

---
# `pivot_longer()`

There are different ways to `pivot_longer()` that will depend on what your data look like 

.pull-left[

```r
pivot_longer(
* data,
* cols,
* names_to = "name",
  names_prefix = NULL,
  names_sep = NULL,
  names_pattern = NULL,
  names_ptypes = list(),
  names_transform = list(),
  names_repair = "check_unique",
* values_to = "value",
  values_drop_na = FALSE,
  values_ptypes = list(),
  values_transform = list(),
  ...
)
```
]

---
# `pivot_longer()`

.pull-left[

```r
pivot_longer(
* data,
* cols,
* names_to = "name",
* values_to = "value",
)
```
]

---
# `pivot_longer()`

.pull-left[

```r
pivot_longer(
* data,
  cols, 
  names_to = "name", 
  values_to = "value", 
)
```
]

.pull-right[
a data frame to pivot

```r
df %&gt;% 
  pivot_wider()
```
*or*

```r
pivot_wider(df)
```
]

---
# `pivot_longer()`

.pull-left[

```r
pivot_longer(
  data, 
* cols,
  names_to = "name", 
  values_to = "value", 
)
```
]

.pull-right[
The names of the `col`umns you want to pivot into longer format
]

---
# `pivot_longer()`

.pull-left[

```r
pivot_longer(
  data, 
  cols, 
* names_to = "name",
  values_to = "value", 
)
```
]

.pull-right[
A string specifying the name of the **new** column to create from the data stored in the `col`umn names of data

Can be a character vector, creating multiple columns, if `names_sep` or `names_pattern` is provided
]

---
# `pivot_longer()`

.pull-left[

```r
pivot_longer(
  data, 
  cols, 
  names_to = "name", 
* values_to = "value",
)
```
]

.pull-right[
A string specifying the name of the **new** column to create from the data stored in cell values of the `col`umns
]

---
# Messy data

What makes this data messy? Or, why is this data not tidy?


```r
tidyr::relig_income
```

```
## # A tibble: 18 x 11
##    religion      `&lt;$10k` $10-2~1 $20-3~2 $30-4~3 $40-5~4 $50-7~5 $75-1~6 $100-~7
##    &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Agnostic           27      34      60      81      76     137     122     109
##  2 Atheist            12      27      37      52      35      70      73      59
##  3 Buddhist           27      21      30      34      33      58      62      39
##  4 Catholic          418     617     732     670     638    1116     949     792
##  5 Don’t know/r~      15      14      15      11      10      35      21      17
##  6 Evangelical ~     575     869    1064     982     881    1486     949     723
##  7 Hindu               1       9       7       9      11      34      47      48
##  8 Historically~     228     244     236     238     197     223     131      81
##  9 Jehovah's Wi~      20      27      24      24      21      30      15      11
## 10 Jewish             19      19      25      25      30      95      69      87
## 11 Mainline Prot     289     495     619     655     651    1107     939     753
## 12 Mormon             29      40      48      51      56     112      85      49
## 13 Muslim              6       7       9      10       9      23      16       8
## 14 Orthodox           13      17      23      32      32      47      38      42
## 15 Other Christ~       9       7      11      13      13      14      18      14
## 16 Other Faiths       20      33      40      46      49      63      46      40
## 17 Other World ~       5       2       3       4       2       7       3       4
## 18 Unaffiliated      217     299     374     365     341     528     407     321
## # ... with 2 more variables: `&gt;150k` &lt;dbl&gt;, `Don't know/refused` &lt;dbl&gt;, and
## #   abbreviated variable names 1: `$10-20k`, 2: `$20-30k`, 3: `$30-40k`,
## #   4: `$40-50k`, 5: `$50-75k`, 6: `$75-100k`, 7: `$100-150k`
```

---
# Messy data

Column headers are values (data!), not variable names


```r
tidyr::relig_income
```

```
## # A tibble: 18 x 11
*##    religion      `&lt;$10k` $10-2~1 $20-3~2 $30-4~3 $40-5~4 $50-7~5 $75-1~6 $100-~7
##    &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Agnostic           27      34      60      81      76     137     122     109
##  2 Atheist            12      27      37      52      35      70      73      59
##  3 Buddhist           27      21      30      34      33      58      62      39
##  4 Catholic          418     617     732     670     638    1116     949     792
##  5 Don’t know/r~      15      14      15      11      10      35      21      17
##  6 Evangelical ~     575     869    1064     982     881    1486     949     723
##  7 Hindu               1       9       7       9      11      34      47      48
##  8 Historically~     228     244     236     238     197     223     131      81
##  9 Jehovah's Wi~      20      27      24      24      21      30      15      11
## 10 Jewish             19      19      25      25      30      95      69      87
## 11 Mainline Prot     289     495     619     655     651    1107     939     753
## 12 Mormon             29      40      48      51      56     112      85      49
## 13 Muslim              6       7       9      10       9      23      16       8
## 14 Orthodox           13      17      23      32      32      47      38      42
## 15 Other Christ~       9       7      11      13      13      14      18      14
## 16 Other Faiths       20      33      40      46      49      63      46      40
## 17 Other World ~       5       2       3       4       2       7       3       4
## 18 Unaffiliated      217     299     374     365     341     528     407     321
## # ... with 2 more variables: `&gt;150k` &lt;dbl&gt;, `Don't know/refused` &lt;dbl&gt;, and
## #   abbreviated variable names 1: `$10-20k`, 2: `$20-30k`, 3: `$30-40k`,
## #   4: `$40-50k`, 5: `$50-75k`, 6: `$75-100k`, 7: `$100-150k`
```

---
# Let's `pivot_longer()`

Necessary arguments
* `data` - of course
* `cols` – which columns you will pivot longer
* `names_to` – new variable name (in quotes) for those `cols`
* `values_to` – new variable name (in quotes) for the cell values

---
# Let's `pivot_longer()`

.left-column[

```r
relig_income %&gt;% 
 pivot_longer(
  cols = _____,
  names_to = "_____",
  values_to = "_____"
 )
```
]
.right-column[

```
## # A tibble: 18 x 11
##    religion      `&lt;$10k` $10-2~1 $20-3~2 $30-4~3 $40-5~4 $50-7~5 $75-1~6 $100-~7
##    &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Agnostic           27      34      60      81      76     137     122     109
##  2 Atheist            12      27      37      52      35      70      73      59
##  3 Buddhist           27      21      30      34      33      58      62      39
##  4 Catholic          418     617     732     670     638    1116     949     792
##  5 Don’t know/r~      15      14      15      11      10      35      21      17
##  6 Evangelical ~     575     869    1064     982     881    1486     949     723
##  7 Hindu               1       9       7       9      11      34      47      48
##  8 Historically~     228     244     236     238     197     223     131      81
##  9 Jehovah's Wi~      20      27      24      24      21      30      15      11
## 10 Jewish             19      19      25      25      30      95      69      87
## 11 Mainline Prot     289     495     619     655     651    1107     939     753
## 12 Mormon             29      40      48      51      56     112      85      49
## 13 Muslim              6       7       9      10       9      23      16       8
## 14 Orthodox           13      17      23      32      32      47      38      42
## 15 Other Christ~       9       7      11      13      13      14      18      14
## 16 Other Faiths       20      33      40      46      49      63      46      40
## 17 Other World ~       5       2       3       4       2       7       3       4
## 18 Unaffiliated      217     299     374     365     341     528     407     321
## # ... with 2 more variables: `&gt;150k` &lt;dbl&gt;, `Don't know/refused` &lt;dbl&gt;, and
## #   abbreviated variable names 1: `$10-20k`, 2: `$20-30k`, 3: `$30-40k`,
## #   4: `$40-50k`, 5: `$50-75k`, 6: `$75-100k`, 7: `$100-150k`
```
]

---
# Let's `pivot_longer()`

.pull-left[

```r
relig_income %&gt;% 
  pivot_longer(
    cols = -religion,
    names_to = "income",
    values_to = "frequency"
  )
```
]
.pull-right[

```
## # A tibble: 180 x 3
##    religion income             frequency
##    &lt;chr&gt;    &lt;chr&gt;                  &lt;dbl&gt;
##  1 Agnostic &lt;$10k                     27
##  2 Agnostic $10-20k                   34
##  3 Agnostic $20-30k                   60
##  4 Agnostic $30-40k                   81
##  5 Agnostic $40-50k                   76
##  6 Agnostic $50-75k                  137
##  7 Agnostic $75-100k                 122
##  8 Agnostic $100-150k                109
##  9 Agnostic &gt;150k                     84
## 10 Agnostic Don't know/refused        96
## # ... with 170 more rows
```
]

---
# Why are tidy data useful?

When used with `{dplyr}`, tidy data can result in large gains in efficiency

For example, suppose we want to calculate the percent of respondents in each income category *by* religion

--

**First** let's save our pivoted data


```r
relig_long &lt;- relig_income %&gt;% 
  pivot_longer(
    cols = -religion,
    names_to = "income",
    values_to = "frequency"
  ) 
```

---
# Why are tidy data useful?

When used with `{dplyr}`, tidy data can result in large gains in efficiency

For example, suppose we want to calculate the percent of respondents in each income category *by* religion

**Then** let's relevel the `income` variable so it is ordered in a meaningful way


```r
relig_long &lt;- relig_long %&gt;% 
  mutate(income = fct_relevel(income, 
                              "Don't know/refused", 
                              "&lt;$10k", 
                              "$10-20k", 
                              "$20-30k", 
                              "$30-40k", 
                              "$40-50k", 
                              "$50-75k", 
                              "$75-100k", 
                              "$100-150k", 
                              "&gt;150k")) 
```

---
# Why are tidy data useful?

When used with `{dplyr}`, tidy data can result in large gains in efficiency

For example, suppose we want to calculate the percent of respondents in each income category *by* religion

**Now** let's group by `religion` to create a `pct` variable that indicates the percent of respondents in each income category *within* each religion category


```r
relig_long %&gt;% 
  group_by(religion) %&gt;% 
  mutate(pct = frequency/sum(frequency) * 100)
```

```
## # A tibble: 180 x 4
## # Groups:   religion [18]
##    religion income             frequency   pct
##    &lt;chr&gt;    &lt;fct&gt;                  &lt;dbl&gt; &lt;dbl&gt;
##  1 Agnostic &lt;$10k                     27  3.27
##  2 Agnostic $10-20k                   34  4.12
##  3 Agnostic $20-30k                   60  7.26
##  4 Agnostic $30-40k                   81  9.81
##  5 Agnostic $40-50k                   76  9.20
##  6 Agnostic $50-75k                  137 16.6 
##  7 Agnostic $75-100k                 122 14.8 
##  8 Agnostic $100-150k                109 13.2 
##  9 Agnostic &gt;150k                     84 10.2 
## 10 Agnostic Don't know/refused        96 11.6 
## # ... with 170 more rows
```

---
# Why are tidy data useful?

When used with .bg-yellow[`{ggplot2}`], tidy data can result in large gains in efficiency

**Now** we can facet by religion and see all data at once!


```r
relig_long %&gt;% 
  group_by(religion) %&gt;% 
  mutate(pct = frequency/sum(frequency) * 100) %&gt;% 
  ggplot(aes(income, pct)) +
  geom_point() +
  geom_line(group = 1) +
  facet_wrap(~religion)
```

&lt;img src="w8_tidydata_files/figure-html/unnamed-chunk-22-1.png" width="100%" /&gt;

---

# Messy data

Many variables in column names

`tidyr::who` (modified slightly)

```
## # A tibble: 7,240 x 60
*##    country     iso2  iso3   year new_s~1 new_s~2 new_s~3 new_s~4 new_s~5 new_s~6
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;
##  1 Afghanistan AF    AFG    1980      NA      NA      NA      NA      NA      NA
##  2 Afghanistan AF    AFG    1981      NA      NA      NA      NA      NA      NA
##  3 Afghanistan AF    AFG    1982      NA      NA      NA      NA      NA      NA
##  4 Afghanistan AF    AFG    1983      NA      NA      NA      NA      NA      NA
##  5 Afghanistan AF    AFG    1984      NA      NA      NA      NA      NA      NA
##  6 Afghanistan AF    AFG    1985      NA      NA      NA      NA      NA      NA
##  7 Afghanistan AF    AFG    1986      NA      NA      NA      NA      NA      NA
##  8 Afghanistan AF    AFG    1987      NA      NA      NA      NA      NA      NA
##  9 Afghanistan AF    AFG    1988      NA      NA      NA      NA      NA      NA
## 10 Afghanistan AF    AFG    1989      NA      NA      NA      NA      NA      NA
## # ... with 7,230 more rows, 50 more variables: new_sp_m_65 &lt;int&gt;,
## #   new_sp_f_014 &lt;int&gt;, new_sp_f_1524 &lt;int&gt;, new_sp_f_2534 &lt;int&gt;,
## #   new_sp_f_3544 &lt;int&gt;, new_sp_f_4554 &lt;int&gt;, new_sp_f_5564 &lt;int&gt;,
## #   new_sp_f_65 &lt;int&gt;, new_sn_m_014 &lt;int&gt;, new_sn_m_1524 &lt;int&gt;,
## #   new_sn_m_2534 &lt;int&gt;, new_sn_m_3544 &lt;int&gt;, new_sn_m_4554 &lt;int&gt;,
## #   new_sn_m_5564 &lt;int&gt;, new_sn_m_65 &lt;int&gt;, new_sn_f_014 &lt;int&gt;,
## #   new_sn_f_1524 &lt;int&gt;, new_sn_f_2534 &lt;int&gt;, new_sn_f_3544 &lt;int&gt;, ...
```

---
# Messy data

Many variables in column names

.pull-left[
* Example column names

`new_sp_m_014`

`new_rel_f_65`
]

---
# Messy data

Many variables in column names

.pull-left[
* Example column names

.darkorange[new].black[\\_].green[sp].black[\\_].darkblue[m]_.pink[014]

.darkorange[new].black[\\_].green[rel].black[\\_].darkblue[f]_.pink[65]
]

--

.pull-right[
all col names start with .darkorange["new_"], which we don't need

followed by a diagnosis category: .green["sp_", "sn_", "ep_", "rel_"]

then .darkblue[sex], which in these data is limited to only .darkblue["m_"] or .darkblue["f_"]

and an .pink[age range]

&lt;u&gt;and&lt;/u&gt; these are separated by underscores `_` which is quite convenient, as we'll see
]

--

That's a lot of information in the column names!

---
# Messy data

#### Many variables in column names

Necessary arguments
* `data` - of course
* `cols` – which columns you will pivot longer
* `names_to` – new variable name**s** (in quotes) for those `cols`
* `values_to` – new variable name (in quotes) for the cell values
* .bg-yellow[`names_separate` – how to *separate* those `cols` names]

---
# Let's apply it


```r
who_r %&gt;%
 pivot_longer(
  cols = new_sp_m_014:new_rel_f_65,
  names_to = c("new", "diagnosis", "sex", "age"), 
  names_sep = "_",
  values_to = "count"
)
```

```
## # A tibble: 405,440 x 9
*##    country     iso2  iso3   year new   diagnosis sex   age   count
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
##  1 Afghanistan AF    AFG    1980 new   sp        m     014      NA
##  2 Afghanistan AF    AFG    1980 new   sp        m     1524     NA
##  3 Afghanistan AF    AFG    1980 new   sp        m     2534     NA
##  4 Afghanistan AF    AFG    1980 new   sp        m     3544     NA
##  5 Afghanistan AF    AFG    1980 new   sp        m     4554     NA
##  6 Afghanistan AF    AFG    1980 new   sp        m     5564     NA
##  7 Afghanistan AF    AFG    1980 new   sp        m     65       NA
##  8 Afghanistan AF    AFG    1980 new   sp        f     014      NA
##  9 Afghanistan AF    AFG    1980 new   sp        f     1524     NA
## 10 Afghanistan AF    AFG    1980 new   sp        f     2534     NA
## # ... with 405,430 more rows
```

---
# Don’t get discouraged

* This is tricky!

* Takes practice

* Takes trial and error

* Takes looking at the [help documentation](https://tidyr.tidyverse.org/reference/pivot_longer.html) and the [vignette](https://tidyr.tidyverse.org/articles/pivot.html) - &lt;u&gt;a lot&lt;/u&gt;

* But you are ~~rarely~~ never gifted with tidy data

---
# Declaring `cols` to `pivot_longer`

We can declare the columns to pivot other ways

The important part is just being clear which columns should be part of the gather

All of the below are equivalent

.pull-left[
#### `relig_income` data


```r
relig_income %&gt;% 
  pivot_longer(
    cols = -religion,
    ...
```


```r
relig_income %&gt;% 
  pivot_longer(
    cols = -1,
    ...
```


```r
names(relig_income) %&gt;% 
  pivot_longer(
    cols = c(`&lt;$10k`:`Don't know/refused`),
    ...
```
]

.pull-right[
#### `who` data


```r
names(who) %&gt;% 
  pivot_longer(
    cols = new_sp_m_014:new_rel_f_65,
    ...
```


```r
names(who) %&gt;% 
  pivot_longer(
    cols = starts_with("new_"),
    ...
```
]

---
## Let’s look at some education data

Load the *exam1.csv* data from the course website or from your cloned course repo
  + Did you clone the course repo? 

Start a new `R` script or Rmd


```r
library(tidyverse)
library(here)
exam &lt;- read_csv(here("data", "exam1.csv"))
```

---
# exam1 data


```
## # A tibble: 35 x 20
##    stu_n~1 gender item_1 item_2 item_3 item_4 item_5 item_6 item_7 item_8 item_9
##    &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 Adam    M           1      1      1      1      1      1      1      0      0
##  2 Anne    F           1      1      1      1      1      1      1      1      1
##  3 Audrey  F           1      1      1      1      1      1      1      1      1
##  4 Barbara F           1      1      1      1      0      0      1      0      0
##  5 Bert    M           1      1      1      1      1      0      1      0      1
##  6 Betty   F           1      1      1      1      1      1      1      1      1
##  7 Blaise  M           1      1      1      1      1      1      1      1      1
##  8 Brenda  F           1      1      1      1      1      1      1      1      1
##  9 Britton F           1      1      1      0      1      1      1      1      1
## 10 Carol   F           1      1      1      1      0      0      1      0      1
## # ... with 25 more rows, 9 more variables: item_10 &lt;dbl&gt;, item_11 &lt;dbl&gt;,
## #   item_12 &lt;dbl&gt;, item_13 &lt;dbl&gt;, item_14 &lt;dbl&gt;, item_15 &lt;dbl&gt;, item_16 &lt;dbl&gt;,
## #   item_17 &lt;dbl&gt;, item_18 &lt;dbl&gt;, and abbreviated variable name 1: stu_name
```

---
# Talk with a neighbor

* Are these data tidy?

* If not, what needs to happen to make them tidy?

* What are the variables? What are the values?

<div class="countdown" id="timer_ac446dd3" data-warn-when="30" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
# exam1 data

What do we want?

--

Let’s change all *item* variables into two variables: *item* and *score*

--


```
## # A tibble: 630 x 4
##    stu_name gender item    score
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;
##  1 Adam     M      item_1      1
##  2 Adam     M      item_2      1
##  3 Adam     M      item_3      1
##  4 Adam     M      item_4      1
##  5 Adam     M      item_5      1
##  6 Adam     M      item_6      1
##  7 Adam     M      item_7      1
##  8 Adam     M      item_8      0
##  9 Adam     M      item_9      0
## 10 Adam     M      item_10     0
## # ... with 620 more rows
```

---
# Try to tidy!

Necessary arguments
* `data` - of course
* `cols` – which columns you will pivot longer
* `names_to` – new variable name (in quotes) for those `cols`
  + *"item"*
* `values_to` – new variable name (in quotes) for the cell values
  * *"score"*

<div class="countdown" id="timer_a45a030a" data-warn-when="30" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

**Don't look ahead!**

---
# exam1 tidy


```r
exam %&gt;% 
  pivot_longer(
    cols = starts_with("item"),
    names_to = "item",
    values_to = "score"
  )
```

```
## # A tibble: 630 x 4
##    stu_name gender item    score
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;
##  1 Adam     M      item_1      1
##  2 Adam     M      item_2      1
##  3 Adam     M      item_3      1
##  4 Adam     M      item_4      1
##  5 Adam     M      item_5      1
##  6 Adam     M      item_6      1
##  7 Adam     M      item_7      1
##  8 Adam     M      item_8      0
##  9 Adam     M      item_9      0
## 10 Adam     M      item_10     0
## # ... with 620 more rows
```

---
# exam1 tidy

Let's go one step further


```r
exam %&gt;% 
  pivot_longer(
    cols = starts_with("item"),
    names_to = "item",
*   names_prefix = "item_",
    values_to = "score"
  )
```

```
## # A tibble: 630 x 4
##    stu_name gender item  score
*##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;
##  1 Adam     M      1         1
##  2 Adam     M      2         1
##  3 Adam     M      3         1
##  4 Adam     M      4         1
##  5 Adam     M      5         1
##  6 Adam     M      6         1
##  7 Adam     M      7         1
##  8 Adam     M      8         0
##  9 Adam     M      9         0
## 10 Adam     M      10        0
## # ... with 620 more rows
```

---
# exam1 tidy

And another step


```r
exam %&gt;% 
  pivot_longer(
    cols = starts_with("item"),
    names_to = "item",
    names_prefix = "item_",
*   names_transform = list(item = as.integer),
    values_to = "score"
  )
```

```
## # A tibble: 630 x 4
##    stu_name gender  item score
*##    &lt;chr&gt;    &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;
##  1 Adam     M          1     1
##  2 Adam     M          2     1
##  3 Adam     M          3     1
##  4 Adam     M          4     1
##  5 Adam     M          5     1
##  6 Adam     M          6     1
##  7 Adam     M          7     1
##  8 Adam     M          8     0
##  9 Adam     M          9     0
## 10 Adam     M         10     0
## # ... with 620 more rows
```

---
# exam1 tidy

One more step


```r
exam_tidy &lt;- exam %&gt;% 
  pivot_longer(
    cols = starts_with("item"),
    names_to = "item",
    names_prefix = "item_",
*   names_transform = list(item = as.integer),
    values_to = "score"
  )
```

Why not quotes around *item* here, but quotes as it appears in `names_to`?

---
# One more look at `names_prefix`


```r
who_r %&gt;%
 pivot_longer(
  cols = new_sp_m_014:new_rel_f_65,
* names_to = c("new", "diagnosis", "sex", "age"),
  names_sep = "_",
  values_to = "count"
)
```

```
## # A tibble: 405,440 x 9
*##    country     iso2  iso3   year new   diagnosis sex   age   count
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
##  1 Afghanistan AF    AFG    1980 new   sp        m     014      NA
##  2 Afghanistan AF    AFG    1980 new   sp        m     1524     NA
##  3 Afghanistan AF    AFG    1980 new   sp        m     2534     NA
##  4 Afghanistan AF    AFG    1980 new   sp        m     3544     NA
##  5 Afghanistan AF    AFG    1980 new   sp        m     4554     NA
##  6 Afghanistan AF    AFG    1980 new   sp        m     5564     NA
##  7 Afghanistan AF    AFG    1980 new   sp        m     65       NA
##  8 Afghanistan AF    AFG    1980 new   sp        f     014      NA
##  9 Afghanistan AF    AFG    1980 new   sp        f     1524     NA
## 10 Afghanistan AF    AFG    1980 new   sp        f     2534     NA
## # ... with 405,430 more rows
```

---
# One more look at `names_prefix`


```r
who_r %&gt;%
 pivot_longer(
  cols = new_sp_m_014:new_rel_f_65,
  names_to = c("diagnosis", "sex", "age"), 
* names_prefix = "new_",
  names_sep = "_",
  values_to = "count"
)
```

```
## # A tibble: 405,440 x 8
*##    country     iso2  iso3   year diagnosis sex   age   count
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
##  1 Afghanistan AF    AFG    1980 sp        m     014      NA
##  2 Afghanistan AF    AFG    1980 sp        m     1524     NA
##  3 Afghanistan AF    AFG    1980 sp        m     2534     NA
##  4 Afghanistan AF    AFG    1980 sp        m     3544     NA
##  5 Afghanistan AF    AFG    1980 sp        m     4554     NA
##  6 Afghanistan AF    AFG    1980 sp        m     5564     NA
##  7 Afghanistan AF    AFG    1980 sp        m     65       NA
##  8 Afghanistan AF    AFG    1980 sp        f     014      NA
##  9 Afghanistan AF    AFG    1980 sp        f     1524     NA
## 10 Afghanistan AF    AFG    1980 sp        f     2534     NA
## # ... with 405,430 more rows
```

---
# Why are tidy data useful?

**Question**: How would we calculate the proportion of students responding correctly to each item?

---
# Why are tidy data useful?

**Question**: How would we calculate the proportion of students responding correctly to each item?


```
## # A tibble: 18 x 2
##     item   prop
##    &lt;int&gt;  &lt;dbl&gt;
##  1     1 1     
##  2     2 1     
##  3     3 1     
##  4     4 0.914 
##  5     5 0.886 
##  6     6 0.857 
##  7     7 0.886 
##  8     8 0.771 
##  9     9 0.857 
## 10    10 0.686 
## 11    11 0.343 
## 12    12 0.171 
## 13    13 0.2   
## 14    14 0.0857
## 15    15 0.0286
## 16    16 0.0286
## 17    17 0.0286
## 18    18 0
```

---
# Why are tidy data useful?

**Answer**: We `group_by(item)` and `summarize()`


```r
exam_tidy %&gt;% 
  group_by(item) %&gt;% 
  summarize(prop = mean(score))
```

```
## # A tibble: 18 x 2
##     item   prop
##    &lt;int&gt;  &lt;dbl&gt;
##  1     1 1     
##  2     2 1     
##  3     3 1     
##  4     4 0.914 
##  5     5 0.886 
##  6     6 0.857 
##  7     7 0.886 
##  8     8 0.771 
##  9     9 0.857 
## 10    10 0.686 
## 11    11 0.343 
## 12    12 0.171 
## 13    13 0.2   
## 14    14 0.0857
## 15    15 0.0286
## 16    16 0.0286
## 17    17 0.0286
## 18    18 0
```

---
# Why are tidy data useful?

**Question**: What if we wanted to know the proportion correct for each item by gender?

---
# Why are tidy data useful?

**Question**: What if we wanted to know the proportion correct for each item by gender?


```r
exam_tidy %&gt;% 
  group_by(item, gender) %&gt;% 
  summarize(prop = mean(score))
```

```
## # A tibble: 36 x 3
## # Groups:   item [18]
##     item gender  prop
##    &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1     1 F      1    
##  2     1 M      1    
##  3     2 F      1    
##  4     2 M      1    
##  5     3 F      1    
##  6     3 M      1    
##  7     4 F      0.889
##  8     4 M      0.941
##  9     5 F      0.833
## 10     5 M      0.941
## # ... with 26 more rows
```

---
# More data

Load the *year-end_scores.csv* data from the course website or from your cloned course repo
  + Name the data `scores`


```r
scores &lt;- read_csv(here("data", "year-end_scores.csv"))
```



---
# Talk as a class

* Are these data tidy?
  + If you wanted to summarize scores, or plot and use facet, what would you use to `group_by()` or `facet_wrap()`?

* What do we need to do to make these tidy?
  + What `pivot_longer()` arguments do we need?

--

Work as a class to tidy, name new data *scores_tidy*

<div class="countdown" id="timer_90f1bc31" data-warn-when="30" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>



---
# Let's try another

Load the *longitudinal_sim.csv* data from course website or your cloned course repo
  + Name the data `sim`
  

```r
sim &lt;- read_csv(here("data", "longitudinal_sim.csv"))
```



---
# Talk with a neighbor

* Are these data tidy?
  + If you wanted to summarize scores, or plot and use facet, what would you use to `group_by()` or `facet_wrap()`?

* What do we need to do to make these tidy?
  + What `pivot_longer()` arguments do we need?

--

Work with your neighbor to tidy, name new data `tidy_sim*`

<div class="countdown" id="timer_b4debeb8" data-warn-when="30" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

Tell me your solutions .darkorange[[demo a couple]]




---
# Other possible issues

The *hiv* data




```r
hiv &lt;- read_csv(here("data", "hiv.csv"))
```

---
# Other possible issues

Let's make some manipulations (just `{dplyr}` variety `filter()` and `select()`) to get a sample of the data


```r
(hiv_r &lt;- hiv %&gt;% 
  filter(country == "France" |
          country == "South Africa" |
            country == "United States") %&gt;% 
  select(country, `1979`, `1989`, `1999`, `2009`))
```

```
## # A tibble: 3 x 5
##   country        `1979` `1989` `1999` `2009`
##   &lt;chr&gt;           &lt;dbl&gt; &lt;lgl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1 France        NA      NA        0.3    0.4
## 2 South Africa  NA      NA       14.8   17.2
## 3 United States  0.0318 NA        0.5    0.6
```

* Are these data tidy?

* How would you add a new variable - say, *percent HIV*?

* Discuss how you would transform these data, if at all

---
# Tidy the data


```r
(hiv_tidy &lt;- hiv_r %&gt;% 
  pivot_longer(
    cols = -1,
    names_to = "year",
    values_to = "percentage"
  ))
```

```
## # A tibble: 12 x 3
##    country       year  percentage
##    &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;
##  1 France        1979     NA     
##  2 France        1989     NA     
##  3 France        1999      0.3   
##  4 France        2009      0.4   
##  5 South Africa  1979     NA     
##  6 South Africa  1989     NA     
##  7 South Africa  1999     14.8   
##  8 South Africa  2009     17.2   
##  9 United States 1979      0.0318
## 10 United States 1989     NA     
## 11 United States 1999      0.5   
## 12 United States 2009      0.6
```

---
# Let's plot it


```r
hiv_tidy %&gt;% 
  ggplot(aes(year, percentage, color = country, group = country)) +
  geom_point(size = 4) +
  geom_line(size = 2)
```

&lt;img src="w8_tidydata_files/figure-html/unnamed-chunk-56-1.png" width="100%" /&gt;

---
# Let's plot it

There is a problem with the data – what is it?

&lt;img src="w8_tidydata_files/figure-html/unnamed-chunk-57-1.png" width="100%" /&gt;

--

Why aren’t lines connecting for the United States?

---
# Missing data


```r
hiv_tidy
```

```
## # A tibble: 12 x 3
##    country       year  percentage
##    &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;
##  1 France        1979     NA     
##  2 France        1989     NA     
##  3 France        1999      0.3   
##  4 France        2009      0.4   
##  5 South Africa  1979     NA     
##  6 South Africa  1989     NA     
##  7 South Africa  1999     14.8   
##  8 South Africa  2009     17.2   
##  9 United States 1979      0.0318
## 10 United States 1989     NA     
## 11 United States 1999      0.5   
## 12 United States 2009      0.6
```

---
# Drop `NA`s


```r
hiv_tidy %&gt;% 
  drop_na(percentage)
```

**OR**

(not generally ideal unless you are &lt;b&gt;certain&lt;/b&gt; you can remove these missing data)


```r
hiv_tidy &lt;- hiv_r %&gt;% 
  pivot_longer(
    cols = -1,
    names_to = "year",
    values_to = "percentage",
    names_transform = list(year = as.integer),
*   values_drop_na = TRUE
  )
```

---
# Plot again


```r
hiv_tidy %&gt;% 
  ggplot(aes(year, percentage, color = country, group = country)) +
  geom_point(size = 4) +
  geom_line(size = 2)
```

&lt;img src="w8_tidydata_files/figure-html/unnamed-chunk-61-1.png" width="100%" /&gt;

---
class: inverse, left, middle

# pivot_wider()

---
# [`pivot_wider()`](https://tidyr.tidyverse.org/reference/pivot_wider.html)

Tidy data are excellent when conducting preliminary descriptive analyses, plotting data, linear models

* Occasionally, you need the data in a different format
  + For example, if you're using other packages for analysis

---
# `pivot_wider()`

.pull-left[

```r
pivot_wider(
  data,
  id_cols = NULL,
  names_from = name,
  names_prefix = "",
  names_sep = "_",
  names_glue = NULL,
  names_sort = FALSE,
  names_repair = "check_unique",
  values_from = value,
  values_fill = NULL,
  values_fn = NULL,
  ...
)
```
]

---
# `pivot_wider()`

.pull-left[

```r
pivot_wider(
* data,
  id_cols = NULL,
* names_from = name,
  names_prefix = "",
  names_sep = "_",
  names_glue = NULL,
  names_sort = FALSE,
  names_repair = "check_unique",
* values_from = value,
  values_fill = NULL,
  values_fn = NULL,
  ...
)
```
]

---
# `pivot_wider()`

.pull-left[

```r
pivot_wider(
* data,
* names_from = name,
* values_from = value
)
```
]

---
# `pivot_wider()`

.pull-left[

```r
pivot_wider(
  data, 
* names_from = name,
  values_from = value
)
```
]

.pull-right[
The names of the (tidy) column (or columns) from which to get the name of the new data columns
]

---
# `pivot_wider()`

.pull-left[

```r
pivot_wider(
  data, 
  names_from = name, 
* values_from = value
)
```
]

.pull-right[
The names of the (tidy) column (or columns) from which to get the the cell values
]

---
# An example

**fish_encounters**: when fish swimming down a river are detected by automatic monitoring stations


```r
tidyr::fish_encounters
```

```
## # A tibble: 114 x 3
##    fish  station  seen
##    &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;
##  1 4842  Release     1
##  2 4842  I80_1       1
##  3 4842  Lisbon      1
##  4 4842  Rstr        1
##  5 4842  Base_TD     1
##  6 4842  BCE         1
##  7 4842  BCW         1
##  8 4842  BCE2        1
##  9 4842  BCW2        1
## 10 4842  MAE         1
## # ... with 104 more rows
```

---
# An example

So tidy, so nice...let's muck it up


```r
fish_encounters %&gt;% 
  pivot_wider(
    names_from = station, 
    values_from = seen,
)
```

```
## # A tibble: 19 x 12
##    fish  Release I80_1 Lisbon  Rstr Base_TD   BCE   BCW  BCE2  BCW2   MAE   MAW
##    &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 4842        1     1      1     1       1     1     1     1     1     1     1
##  2 4843        1     1      1     1       1     1     1     1     1     1     1
##  3 4844        1     1      1     1       1     1     1     1     1     1     1
##  4 4845        1     1      1     1       1    NA    NA    NA    NA    NA    NA
##  5 4847        1     1      1    NA      NA    NA    NA    NA    NA    NA    NA
##  6 4848        1     1      1     1      NA    NA    NA    NA    NA    NA    NA
##  7 4849        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
##  8 4850        1     1     NA     1       1     1     1    NA    NA    NA    NA
##  9 4851        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
## 10 4854        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
## 11 4855        1     1      1     1       1    NA    NA    NA    NA    NA    NA
## 12 4857        1     1      1     1       1     1     1     1     1    NA    NA
## 13 4858        1     1      1     1       1     1     1     1     1     1     1
## 14 4859        1     1      1     1       1    NA    NA    NA    NA    NA    NA
## 15 4861        1     1      1     1       1     1     1     1     1     1     1
## 16 4862        1     1      1     1       1     1     1     1     1    NA    NA
## 17 4863        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
## 18 4864        1     1     NA    NA      NA    NA    NA    NA    NA    NA    NA
## 19 4865        1     1      1    NA      NA    NA    NA    NA    NA    NA    NA
```

---
# An example

So tidy, so nice...let's muck it up


```r
fish_encounters %&gt;% 
  pivot_wider(
    names_from = station, 
    values_from = seen,
*   values_fill = list(seen = 0)
)
```

```
## # A tibble: 19 x 12
##    fish  Release I80_1 Lisbon  Rstr Base_TD   BCE   BCW  BCE2  BCW2   MAE   MAW
##    &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 4842        1     1      1     1       1     1     1     1     1     1     1
##  2 4843        1     1      1     1       1     1     1     1     1     1     1
##  3 4844        1     1      1     1       1     1     1     1     1     1     1
##  4 4845        1     1      1     1       1     0     0     0     0     0     0
##  5 4847        1     1      1     0       0     0     0     0     0     0     0
##  6 4848        1     1      1     1       0     0     0     0     0     0     0
##  7 4849        1     1      0     0       0     0     0     0     0     0     0
##  8 4850        1     1      0     1       1     1     1     0     0     0     0
##  9 4851        1     1      0     0       0     0     0     0     0     0     0
## 10 4854        1     1      0     0       0     0     0     0     0     0     0
## 11 4855        1     1      1     1       1     0     0     0     0     0     0
## 12 4857        1     1      1     1       1     1     1     1     1     0     0
## 13 4858        1     1      1     1       1     1     1     1     1     1     1
## 14 4859        1     1      1     1       1     0     0     0     0     0     0
## 15 4861        1     1      1     1       1     1     1     1     1     1     1
## 16 4862        1     1      1     1       1     1     1     1     1     0     0
## 17 4863        1     1      0     0       0     0     0     0     0     0     0
## 18 4864        1     1      0     0       0     0     0     0     0     0     0
## 19 4865        1     1      1     0       0     0     0     0     0     0     0
```

---
# Remember `scores_tidy`?


```r
scores_tidy
```

```
## # A tibble: 20 x 7
##       id   sex ethnicity  sped frl   content score
##    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1     1     0         5     0 NA    math      101
##  2     1     0         5     0 NA    read       99
##  3     2     1         2     0 NA    math       96
##  4     2     1         2     0 NA    read       NA
##  5     3     1         5     0 NA    math      131
##  6     3     1         5     0 NA    read      119
##  7     4     1         4     0 NA    math       84
##  8     4     1         4     0 NA    read       93
##  9     5     0         1     0 NA    math      110
## 10     5     0         1     0 NA    read      118
## 11     6     0         5     1 NA    math       NA
## 12     6     0         5     1 NA    read      105
## 13     7     1         5     1 NA    math       93
## 14     7     1         5     1 NA    read       99
## 15     8     0         3     0 NA    math       81
## 16     8     0         3     0 NA    read       77
## 17     9     1         2     0 NA    math      129
## 18     9     1         2     0 NA    read      135
## 19    10     0         1     0 NA    math      117
## 20    10     0         1     0 NA    read      122
```

---
# Untidy `scores_tidy`

.pull-left[

```r
scores_tidy %&gt;% 
  pivot_wider(
    names_from = content,
    values_from = score
  )
```

```
## # A tibble: 10 x 7
##       id   sex ethnicity  sped frl    math  read
##    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1     0         5     0 NA      101    99
##  2     2     1         2     0 NA       96    NA
##  3     3     1         5     0 NA      131   119
##  4     4     1         4     0 NA       84    93
##  5     5     0         1     0 NA      110   118
##  6     6     0         5     1 NA       NA   105
##  7     7     1         5     1 NA       93    99
##  8     8     0         3     0 NA       81    77
##  9     9     1         2     0 NA      129   135
## 10    10     0         1     0 NA      117   122
```
]

--
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

Same as the original data

.pull-right[

```r
read_csv(here("data", "year-end_scores.csv"))
```

```
## # A tibble: 10 x 7
##       id   sex ethnicity  sped frl    math  read
##    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1     0         5     0 NA      101    99
##  2     2     1         2     0 NA       96    NA
##  3     3     1         5     0 NA      131   119
##  4     4     1         4     0 NA       84    93
##  5     5     0         1     0 NA      110   118
##  6     6     0         5     1 NA       NA   105
##  7     7     1         5     1 NA       93    99
##  8     8     0         3     0 NA       81    77
##  9     9     1         2     0 NA      129   135
## 10    10     0         1     0 NA      117   122
```
]

---
# Let's do this together

Use `pivot_wider()` to change *sim_tidy* back to *sim*

.pull-left[

```r
sim_tidy
```

```
## # A tibble: 40 x 4
##      sid wave  content score
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1     1 1     math       95
##  2     1 2     math       98
##  3     1 3     math      102
##  4     1 4     math      105
##  5     1 1     rdg        96
##  6     1 2     rdg        98
##  7     1 3     rdg       101
##  8     1 4     rdg       103
##  9     2 1     math      101
## 10     2 2     math      103
## # ... with 30 more rows
```
]

.pull-right[

```r
sim
```

```
## # A tibble: 5 x 9
##     sid wave_1_math wave_2_math wave_3~1 wave_~2 wave_~3 wave_~4 wave_~5 wave_~6
##   &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1     1          95          98      102     105      96      98     101     103
## 2     2         101         103      107     109     108     110     115     118
## 3     3          99         103      106     110     103     106     109     112
## 4     4         109         111      115     116     108     109     112     116
## 5     5         101         104      107     113      92      95      97     102
## # ... with abbreviated variable names 1: wave_3_math, 2: wave_4_math,
## #   3: wave_1_rdg, 4: wave_2_rdg, 5: wave_3_rdg, 6: wave_4_rdg
```
]

---
# Longer then wider

Some problems can’t be solved by pivoting in a single direction

Here is an example of how you might combine `pivot_longer()` and `pivot_wider()` to solve more complex problems


```r
sim2 &lt;- read_csv(here("data", "longitudinal_sim2.csv"))
head(sim2)
```

```
## # A tibble: 6 x 19
##     SID male_g6 male_g7 male_g8 ell_g6 ell_g7 ell_g8 sped_g6 sped_g7 sped_g8
##   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1     1       1       1       1      0      0      0       0       0       0
## 2     2       0       0       0      0      0      0       0       0       0
## 3     3       1       1       1      0      0      0       0       0       0
## 4     4       1       1       1      0      0      0       0       0       0
## 5     5       0       0       0      0      0      0       1       1       1
## 6     6       0       0       0      0      0      0       0       0       0
## # ... with 9 more variables: pullouts_g6 &lt;dbl&gt;, pullouts_g7 &lt;dbl&gt;,
## #   pullouts_g8 &lt;dbl&gt;, disability_g6 &lt;chr&gt;, disability_g7 &lt;chr&gt;,
## #   disability_g8 &lt;chr&gt;, score_g6 &lt;dbl&gt;, score_g7 &lt;dbl&gt;, score_g8 &lt;dbl&gt;
```

--

.darkorange[[View() data]]

---
# First `pivot_longer()`


```r
sim2 %&gt;% 
  pivot_longer(
    cols = -1,
    names_to = c("variable", "grade"),
    values_to = "values",
    names_sep = "_")
```

```
## Error in `pivot_longer_spec()`:
## ! Can't combine `male_g6` &lt;double&gt; and `disability_g6` &lt;character&gt;.
```

---
# First `pivot_longer()`


```r
sim2 %&gt;% 
  pivot_longer(
    cols = -1,
    names_to = c("variable", "grade"),
    values_to = "values",
    names_sep = "_",
#to combine numeric &amp; character
*   values_transform = list(values = as.character))
```

```
## # A tibble: 1,800 x 4
##      SID variable grade values
##    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; 
##  1     1 male     g6    1     
##  2     1 male     g7    1     
##  3     1 male     g8    1     
##  4     1 ell      g6    0     
##  5     1 ell      g7    0     
##  6     1 ell      g8    0     
##  7     1 sped     g6    0     
##  8     1 sped     g7    0     
##  9     1 sped     g8    0     
## 10     1 pullouts g6    0     
## # ... with 1,790 more rows
```

---
# Let's refine a column using `mutate()`


```r
sim2 %&gt;% 
  pivot_longer(
    cols = -1,
    names_to = c("variable", "grade"),
    values_to = "values",
    names_sep = "_",
    values_transform = list(values = as.character)) %&gt;% 
* mutate(grade = parse_number(grade))
```

```
## # A tibble: 1,800 x 4
##      SID variable grade values
*##    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; 
##  1     1 male         6 1     
##  2     1 male         7 1     
##  3     1 male         8 1     
##  4     1 ell          6 0     
##  5     1 ell          7 0     
##  6     1 ell          8 0     
##  7     1 sped         6 0     
##  8     1 sped         7 0     
##  9     1 sped         8 0     
## 10     1 pullouts     6 0     
## # ... with 1,790 more rows
```

---
# Then `pivot_wider()`


```r
sim2 %&gt;% 
  pivot_longer(
    cols = -1,
    names_to = c("variable", "grade"),
    values_to = "values",
    names_sep = "_",
    values_transform = list(values = as.character)) %&gt;% 
  mutate(grade = parse_number(grade)) %&gt;% 
* pivot_wider(
*   names_from = variable,
*   values_from = values
  )
```

```
## # A tibble: 300 x 8
##      SID grade male  ell   sped  pullouts disability score           
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;           
##  1     1     6 1     0     0     0        none       204.711224219096
##  2     1     7 1     0     0     0        none       207.641655929138
##  3     1     8 1     0     0     0        none       211.468672710232
##  4     2     6 0     0     0     1        none       212.343498534668
##  5     2     7 0     0     0     1        none       217.565910013073
##  6     2     8 0     0     0     1        none       227.036910872597
##  7     3     6 1     0     0     0        none       215.436668173264
##  8     3     7 1     0     0     0        none       217.029498660224
##  9     3     8 1     0     0     0        none       222.232373013961
## 10     4     6 1     0     0     0        none       219.182457533654
## # ... with 290 more rows
```

---


```
## # A tibble: 300 x 8
##      SID grade male  ell   sped  pullouts disability score           
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;           
##  1     1     6 1     0     0     0        none       204.711224219096
##  2     1     7 1     0     0     0        none       207.641655929138
##  3     1     8 1     0     0     0        none       211.468672710232
##  4     2     6 0     0     0     1        none       212.343498534668
##  5     2     7 0     0     0     1        none       217.565910013073
##  6     2     8 0     0     0     1        none       227.036910872597
##  7     3     6 1     0     0     0        none       215.436668173264
##  8     3     7 1     0     0     0        none       217.029498660224
##  9     3     8 1     0     0     0        none       222.232373013961
## 10     4     6 1     0     0     0        none       219.182457533654
## # ... with 290 more rows
```

---
background-size: contain

background-image: url("https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidydata_7.jpg")

---
class: inverse, left, middle

# Next time

---
# Before next class

* Final Project
  + .red[Final Project: Draft Data Script]
* Reading
  + [R4DS 15](https://r4ds.had.co.nz/factors.html)
* Homework
  + **Homework 9**

---
class: inverse, left, middle

# Final Project

---
# Final Project

Final paper: R Markdown document

**Final project must:**
* Be fully reproducible
  + This implies the data are open
  
* Be a collaborative project hosted on GitHub

* Move data from its raw "messy" format to a tidy data format

* Include at least two exploratory plots

* Include at least summary statistics of the data in tables, although fitted models are also encouraged

---
# Final Project - Dates

* **Week 9  (11/23)**: Data prep script due

* **Week 10 (11/30)**:  Peer review due

* **Week 10 (11/30)**:  Final project presentations

* **Week 11 (12/7)**: Final Paper due

---
## Final Project - Data Prep Script

* Expected to be a work in progress

* Provided to your peers so they can learn from you as much as you can learn from their feedback

**Peer Review**

* Understand the purpose of the exercise

* Conducted as a professional product

* Should be **very** encouraging 

* Zero tolerance policy for inappropriate comments

---
# Final Project – Presentation

Groups are expected to present for approximately 25-30 minutes (split evenly among members). Group order randomly assigned. 

Presentation cover the following:
* Share your journey (everyone, at least for a minute or two)

* Discuss challenges you had along the way

* Celebrate your successes

* Discuss challenges you are still facing

* Discuss substantive findings

* Show off your cool figures!

* Discuss next `R` hurdle you want to address

---
## Final Project – Presentation Scoring Rubric

&lt;table class=" lightable-classic table" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-size: 14px; '&gt;
&lt;caption style="font-size: initial !important;"&gt;&lt;b&gt;Final Presentation Rubric&lt;/b&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Criteria &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Points possible &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Challenges faced along the way &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Victories and things to celebrate &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Challenges you are still facing &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Substantive findings/interpretations &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Next R hurdle to tackle &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Total &lt;/td&gt;
   &lt;td style="text-align:right;font-weight: bold;"&gt; 25 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Final Project – Paper

* R Markdown document
  + Abstract, Intro, Methods, Results, Discussion, References
  + Should be brief: 3,500 words max 
  
* No code displayed - think a manuscript being submitted for publication

* Include at least 1 table

* Include at least 2 plots

* Should be fully open, reproducible, and housed on GitHub
  + I should be able to clone your repository, open the R Studio Project, and reproduce the full manuscript (by knitting the R Markdown doc)

---
## Final Paper - Scoring Rubric

<div id="jezpzgddxk" style="overflow-x:auto;overflow-y:auto;width:auto;height:80%;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jezpzgddxk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jezpzgddxk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jezpzgddxk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jezpzgddxk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jezpzgddxk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jezpzgddxk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jezpzgddxk .gt_col_heading {
  color: #FFFFFF;
  background-color: #0072B2;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jezpzgddxk .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #0072B2;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jezpzgddxk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jezpzgddxk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jezpzgddxk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jezpzgddxk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jezpzgddxk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jezpzgddxk .gt_from_md > :first-child {
  margin-top: 0;
}

#jezpzgddxk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jezpzgddxk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jezpzgddxk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jezpzgddxk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jezpzgddxk .gt_row_group_first td {
  border-top-width: 2px;
}

#jezpzgddxk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jezpzgddxk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jezpzgddxk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jezpzgddxk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jezpzgddxk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jezpzgddxk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jezpzgddxk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jezpzgddxk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jezpzgddxk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jezpzgddxk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jezpzgddxk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jezpzgddxk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jezpzgddxk .gt_left {
  text-align: left;
}

#jezpzgddxk .gt_center {
  text-align: center;
}

#jezpzgddxk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jezpzgddxk .gt_font_normal {
  font-weight: normal;
}

#jezpzgddxk .gt_font_bold {
  font-weight: bold;
}

#jezpzgddxk .gt_font_italic {
  font-style: italic;
}

#jezpzgddxk .gt_super {
  font-size: 65%;
}

#jezpzgddxk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#jezpzgddxk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jezpzgddxk .gt_indent_1 {
  text-indent: 5px;
}

#jezpzgddxk .gt_indent_2 {
  text-indent: 10px;
}

#jezpzgddxk .gt_indent_3 {
  text-indent: 15px;
}

#jezpzgddxk .gt_indent_4 {
  text-indent: 20px;
}

#jezpzgddxk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">Criteria</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col">Points Possible</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold; background-color: #FFFFFF;"><div class='gt_from_md'><p>Writing</p>
</div></td>
<td class="gt_row gt_left" style="font-weight: bold; background-color: #FFFFFF;"><div class='gt_from_md'></div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>Abstract</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>Introduction</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>Methods</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>Results</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>Discussion</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>References</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold; background-color: #FFFFFF;"><div class='gt_from_md'><p>Code</p>
</div></td>
<td class="gt_row gt_left" style="font-weight: bold; background-color: #FFFFFF;"><div class='gt_from_md'></div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>Document is fully reproducible</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>25</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>Demonstrate use of inline code</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>At least two data visualizations</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>10 (5 pts each)</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold; background-color: #FFFFFF;"><div class='gt_from_md'><p>Demonstrate tidying messy data using:</p>
</div></td>
<td class="gt_row gt_left" style="font-weight: bold; background-color: #FFFFFF;"><div class='gt_from_md'></div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p><code>pivot_longer()</code></p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p><code>mutate()</code></p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p><code>select()</code> and <code>filter()</code></p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p><code>pivot_wider()</code></p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>At least one table of descriptive statistics</p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>10</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p><code>group_by()</code></p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p><code>summarize()</code></p>
</div></td>
<td class="gt_row gt_left" style="background-color: #FFFFFF;"><div class='gt_from_md'><p>5</p>
</div></td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold; background-color: #FFFFFF;"><div class='gt_from_md'><p>Total</p>
</div></td>
<td class="gt_row gt_left" style="font-weight: bold; background-color: #FFFFFF;"><div class='gt_from_md'><p>110</p>
</div></td></tr>
  </tbody>
  
  
</table>
</div>

---
# Final Project

The following functions: 
* `pivot_longer()`
* `pivot_wider()`
* `mutate()`
* `select()`
* `filter()`
* `group_by()`
* `summarize()`

---
class: inverse, left, middle

---


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
